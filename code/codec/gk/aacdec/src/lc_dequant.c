

#include "struct.h"
#include "decoder.h"

#define TAB_SIZE  1024
#define MAX_INT  0x7fffffff
static const int IQ_Table[TAB_SIZE + 1] ={
	Q11(0.0),
    Q11(1.0),
    Q11(2.5198420997897464),
    Q11(4.3267487109222245),
    Q11(6.3496042078727974),
    Q11(8.5498797333834844),
    Q11(10.902723556992836),
    Q11(13.390518279406722),
    Q11(15.999999999999998),
    Q11(18.720754407467133),
    Q11(21.544346900318832),
    Q11(24.463780996262464),
    Q11(27.47314182127996),
    Q11(30.567350940369842),
    Q11(33.741991698453212),
    Q11(36.993181114957046),
    Q11(40.317473596635935),
    Q11(43.711787041189993),
    Q11(47.173345095760126),
    Q11(50.699631325716943),
    Q11(54.288352331898118),
    Q11(57.937407704003519),
    Q11(61.6448652744185),
    Q11(65.408940536585988),
    Q11(69.227979374755591),
    Q11(73.100443455321638),
    Q11(77.024897778591622),
    Q11(80.999999999999986),
    Q11(85.024491212518527),
    Q11(89.097187944889555),
    Q11(93.216975178615741),
    Q11(97.382800224133163),
    Q11(101.59366732596474),
    Q11(105.84863288986224),
    Q11(110.14680124343441),
    Q11(114.4873208566006),
    Q11(118.86938096020653),
    Q11(123.29220851090024),
    Q11(127.75506545836058),
    Q11(132.25724627755247),
    Q11(136.79807573413572),
    Q11(141.37690685569191),
    Q11(145.99311908523086),
    Q11(150.6461165966291),
    Q11(155.33532675434674),
    Q11(160.06019870205279),
    Q11(164.82020206673349),
    Q11(169.61482576651861),
    Q11(174.44357691188537),
    Q11(179.30597979112557),
    Q11(184.20157493201927),
    Q11(189.12991823257562),
    Q11(194.09058015449685),
    Q11(199.08314497371677),
    Q11(204.1072100829694),
    Q11(209.16238534187647),
    Q11(214.24829247050752),
    Q11(219.36456448277784),
    Q11(224.51084515641216),
    Q11(229.6867885365223),
    Q11(234.89205847013176),
    Q11(240.12632816923249),
    Q11(245.38927980018505),
    Q11(250.68060409747261),
    Q11(255.99999999999991),
    Q11(261.34717430828869),
    Q11(266.72184136106449),
    Q11(272.12372272986045),
    Q11(277.55254693037961),
    Q11(283.0080491494619),
    Q11(288.48997098659891),
    Q11(293.99806020902247),
    Q11(299.53207051947408),
    Q11(305.0917613358298),
    Q11(310.67689758182206),
    Q11(316.28724948815585),
    Q11(321.92259240337177),
    Q11(327.58270661385535),
    Q11(333.26737717243742),
    Q11(338.97639373507025),
    Q11(344.70955040510125),
    Q11(350.46664558470013),
    Q11(356.24748183302603),
    Q11(362.05186573075139),
    Q11(367.87960775058258),
    Q11(373.73052213344511),
    Q11(379.60442677002078),
    Q11(385.50114308734607),
    Q11(391.42049594019937),
    Q11(397.36231350702371),
    Q11(403.32642719014467),
    Q11(409.31267152006262),
    Q11(415.32088406360799),
    Q11(421.35090533576471),
    Q11(427.40257871497619),
    Q11(433.4757503617617),
    Q11(439.5702691404793),
    Q11(445.68598654408271),
    Q11(451.82275662172759),
    Q11(457.98043590909128),
    Q11(464.15888336127773),
    Q11(470.35796028818726),
    Q11(476.5775302922363),
    Q11(482.81745920832043),
    Q11(489.07761504591741),
    Q11(495.35786793323581),
    Q11(501.65809006331688),
    Q11(507.97815564200368),
    Q11(514.31794083769648),
    Q11(520.67732373281672),
    Q11(527.05618427690604),
    Q11(533.45440424129174),
    Q11(539.87186717525128),
    Q11(546.30845836361505),
    Q11(552.76406478574609),
    Q11(559.23857507584194),
    Q11(565.73187948450413),
    Q11(572.24386984152341),
    Q11(578.77443951983378),
    Q11(585.32348340058843),
    Q11(591.89089783931263),
    Q11(598.47658063309257),
    Q11(605.08043098876044),
    Q11(611.70234949203643),
    Q11(618.3422380775919),
    Q11(624.99999999999977),
    Q11(631.67553980553748),
    Q11(638.36876330481164),
    Q11(645.07957754617485),
    Q11(651.80789078990415),
    Q11(658.55361248311499),
    Q11(665.31665323538357),
    Q11(672.09692479505225),
    Q11(678.8943400261943),
    Q11(685.70881288621433),
    Q11(692.540258404062),
    Q11(699.38859265903977),
    Q11(706.25373276018058),
    Q11(713.13559682617972),
    Q11(720.03410396586037),
    Q11(726.94917425915435),
    Q11(733.88072873858209),
    Q11(740.82868937121543),
    Q11(747.79297904110535),
    Q11(754.77352153216191),
    Q11(761.77024151147043),
    Q11(768.78306451302956),
    Q11(775.81191692189896),
    Q11(782.85672595874246),
    Q11(789.91741966475445),
    Q11(796.99392688695798),
    Q11(804.08617726386274),
    Q11(811.19410121147098),
    Q11(818.31762990962227),
    Q11(825.45669528866563),
    Q11(832.61123001644864),
    Q11(839.78116748561604),
    Q11(846.96644180120552),
    Q11(854.16698776853514),
    Q11(861.38274088137143),
    Q11(868.61363731036977),
    Q11(875.85961389178203),
    Q11(883.12060811641959),
    Q11(890.39655811886757),
    Q11(897.68740266694181),
    Q11(904.99308115138172),
    Q11(912.31353357577188),
    Q11(919.64870054668756),
    Q11(926.99852326405619),
    Q11(934.36294351172899),
    Q11(941.74190364825859),
    Q11(949.13534659787422),
    Q11(956.54321584165211),
    Q11(963.96545540887348),
    Q11(971.40200986856541),
    Q11(978.85282432122176),
    Q11(986.31784439069588),
    Q11(993.7970162162635),
    Q11(1001.29028644485),
    Q11(1008.797602223418),
    Q11(1016.3189111915103),
    Q11(1023.8541614739464),
    Q11(1031.4033016736653),
    Q11(1038.9662808647138),
    Q11(1046.5430485853758),
    Q11(1054.1335548314366),
    Q11(1061.7377500495838),
    Q11(1069.3555851309357),
    Q11(1076.9870114046978),
    Q11(1084.6319806319441),
    Q11(1092.2904449995174),
    Q11(1099.9623571140482),
    Q11(1107.6476699960892),
    Q11(1115.3463370743607),
    Q11(1123.058312180106),
    Q11(1130.7835495415541),
    Q11(1138.5220037784854),
    Q11(1146.273629896901),
    Q11(1154.0383832837879),
    Q11(1161.816219701986),
    Q11(1169.607095285146),
    Q11(1177.4109665327808),
    Q11(1185.2277903054078),
    Q11(1193.0575238197798),
    Q11(1200.9001246442001),
    Q11(1208.7555506939248),
    Q11(1216.6237602266442),
    Q11(1224.5047118380478),
    Q11(1232.3983644574657),
    Q11(1240.3046773435874),
    Q11(1248.2236100802568),
    Q11(1256.1551225723395),
    Q11(1264.099175041662),
    Q11(1272.0557280230228),
    Q11(1280.0247423602691),
    Q11(1288.0061792024444),
    Q11(1295.9999999999995),
    Q11(1304.006166501068),
    Q11(1312.0246407478062),
    Q11(1320.0553850727929),
    Q11(1328.0983620954903),
    Q11(1336.1535347187651),
    Q11(1344.2208661254647),
    Q11(1352.3003197750522),
    Q11(1360.3918594002962),
    Q11(1368.4954490040145),
    Q11(1376.6110528558709),
    Q11(1384.7386354892244),
    Q11(1392.8781616980295),
    Q11(1401.0295965337855),
    Q11(1409.1929053025353),
    Q11(1417.3680535619119),
    Q11(1425.5550071182327),
    Q11(1433.7537320236374),
    Q11(1441.9641945732744),
    Q11(1450.1863613025282),
    Q11(1458.4201989842913),
    Q11(1466.6656746262797),
    Q11(1474.9227554683875),
    Q11(1483.1914089800841),
    Q11(1491.4716028578516),
    Q11(1499.7633050226596),
    Q11(1508.0664836174794),
    Q11(1516.3811070048375),
    Q11(1524.7071437644029),
    Q11(1533.0445626906128),
    Q11(1541.3933327903342),
    Q11(1549.7534232805581),
    Q11(1558.1248035861302),
    Q11(1566.507443337515),
    Q11(1574.9013123685909),
    Q11(1583.3063807144795),
    Q11(1591.7226186094069),
    Q11(1600.1499964845941),
    Q11(1608.58848496618),
    Q11(1617.0380548731737),
    Q11(1625.4986772154357),
    Q11(1633.9703231916887),
    Q11(1642.4529641875577),
    Q11(1650.9465717736346),
    Q11(1659.4511177035752),
    Q11(1667.9665739122186),
    Q11(1676.4929125137353),
    Q11(1685.030105799801),
    Q11(1693.5781262377957),
    Q11(1702.136946469027),
    Q11(1710.7065393069795),
    Q11(1719.2868777355877),
    Q11(1727.8779349075323),
    Q11(1736.4796841425596),
    Q11(1745.092098925825),
    Q11(1753.7151529062583),
    Q11(1762.3488198949503),
    Q11(1770.9930738635628),
    Q11(1779.6478889427597),
    Q11(1788.3132394206564),
    Q11(1796.9890997412947),
    Q11(1805.6754445031333),
    Q11(1814.3722484575621),
    Q11(1823.0794865074322),
    Q11(1831.7971337056094),
    Q11(1840.5251652535437),
    Q11(1849.2635564998579),
    Q11(1858.0122829389563),
    Q11(1866.7713202096493),
    Q11(1875.5406440937966),
    Q11(1884.3202305149687),
    Q11(1893.110055537124),
    Q11(1901.9100953633042),
    Q11(1910.7203263343454),
    Q11(1919.5407249276057),
    Q11(1928.3712677557098),
    Q11(1937.2119315653083),
    Q11(1946.0626932358525),
    Q11(1954.923529778386),
    Q11(1963.79441833435),
    Q11(1972.6753361744036),
    Q11(1981.5662606972594),
    Q11(1990.467169428533),
    Q11(1999.3780400196069),
    Q11(2008.2988502465078),
    Q11(2017.2295780087982),
    Q11(2026.1702013284819),
    Q11(2035.1206983489212),
    Q11(2044.0810473337688),
    Q11(2053.0512266659125),
    Q11(2062.0312148464309),
    Q11(2071.0209904935646),
    Q11(2080.0205323416958),
    Q11(2089.0298192403443),
    Q11(2098.0488301531714),
    Q11(2107.0775441569995),
    Q11(2116.115940440839),
    Q11(2125.1639983049317),
    Q11(2134.2216971597995),
    Q11(2143.2890165253098),
    Q11(2152.3659360297484),
    Q11(2161.4524354089031),
    Q11(2170.5484945051617),
    Q11(2179.6540932666144),
    Q11(2188.7692117461711),
    Q11(2197.8938301006888),
    Q11(2207.0279285901042),
    Q11(2216.1714875765838),
    Q11(2225.324487523676),
    Q11(2234.4869089954782),
    Q11(2243.6587326558101),
    Q11(2252.8399392673982),
    Q11(2262.0305096910702),
    Q11(2271.2304248849537),
    Q11(2280.4396659036897),
    Q11(2289.6582138976523),
    Q11(2298.8860501121762),
    Q11(2308.1231558867926),
    Q11(2317.3695126544767),
    Q11(2326.6251019409005),
    Q11(2335.8899053636933),
    Q11(2345.1639046317132),
    Q11(2354.4470815443233),
    Q11(2363.7394179906792),
    Q11(2373.0408959490205),
    Q11(2382.3514974859731),
    Q11(2391.6712047558558),
    Q11(2400.9999999999991),
    Q11(2410.3378655460651),
    Q11(2419.6847838073813),
    Q11(2429.0407372822747),
    Q11(2438.4057085534191),
    Q11(2447.7796802871858),
    Q11(2457.1626352330004),
    Q11(2466.5545562227112),
    Q11(2475.9554261699564),
    Q11(2485.3652280695474),
    Q11(2494.7839449968492),
    Q11(2504.2115601071737),
    Q11(2513.6480566351788),
    Q11(2523.0934178942675),
    Q11(2532.5476272760025),
    Q11(2542.0106682495189),
    Q11(2551.482524360948),
    Q11(2560.9631792328441),
    Q11(2570.4526165636184),
    Q11(2579.9508201269791),
    Q11(2589.4577737713744),
    Q11(2598.9734614194458),
    Q11(2608.4978670674823),
    Q11(2618.0309747848837),
    Q11(2627.5727687136259),
    Q11(2637.1232330677353),
    Q11(2646.6823521327647),
    Q11(2656.2501102652768),
    Q11(2665.8264918923328),
    Q11(2675.4114815109842),
    Q11(2685.0050636877722),
    Q11(2694.6072230582295),
    Q11(2704.2179443263894),
    Q11(2713.8372122642972),
    Q11(2723.4650117115279),
    Q11(2733.1013275747096),
    Q11(2742.7461448270483),
    Q11(2752.3994485078601),
    Q11(2762.0612237221085),
    Q11(2771.7314556399419),
    Q11(2781.4101294962406),
    Q11(2791.0972305901655),
    Q11(2800.7927442847094),
    Q11(2810.4966560062589),
    Q11(2820.2089512441521),
    Q11(2829.9296155502466),
    Q11(2839.6586345384894),
    Q11(2849.3959938844923),
    Q11(2859.1416793251065),
    Q11(2868.8956766580086),
    Q11(2878.6579717412847),
    Q11(2888.4285504930212),
    Q11(2898.2073988908974),
    Q11(2907.9945029717837),
    Q11(2917.789848831344),
    Q11(2927.5934226236377),
    Q11(2937.4052105607311),
    Q11(2947.2251989123079),
    Q11(2957.0533740052865),
    Q11(2966.8897222234368),
    Q11(2976.734230007005),
    Q11(2986.5868838523397),
    Q11(2996.4476703115197),
    Q11(3006.3165759919889),
    Q11(3016.1935875561908),
    Q11(3026.0786917212095),
    Q11(3035.9718752584108),
    Q11(3045.8731249930906),
    Q11(3055.7824278041207),
    Q11(3065.6997706236039),
    Q11(3075.625140436528),
    Q11(3085.5585242804245),
    Q11(3095.4999092450298),
    Q11(3105.4492824719491),
    Q11(3115.4066311543256),
    Q11(3125.3719425365089),
    Q11(3135.3452039137287),
    Q11(3145.3264026317715),
    Q11(3155.3155260866592),
    Q11(3165.3125617243295),
    Q11(3175.3174970403229),
    Q11(3185.3303195794679),
    Q11(3195.35101693557),
    Q11(3205.3795767511078),
    Q11(3215.4159867169251),
    Q11(3225.460234571929),
    Q11(3235.5123081027928),
    Q11(3245.5721951436558),
    Q11(3255.63988357583),
    Q11(3265.7153613275095),
    Q11(3275.7986163734795),
    Q11(3285.8896367348289),
    Q11(3295.9884104786665),
    Q11(3306.0949257178395),
    Q11(3316.2091706106517),
    Q11(3326.331133360588),
    Q11(3336.4608022160378),
    Q11(3346.5981654700231),
    Q11(3356.7432114599264),
    Q11(3366.8959285672249),
    Q11(3377.0563052172211),
    Q11(3387.2243298787821),
    Q11(3397.3999910640764),
    Q11(3407.5832773283128),
    Q11(3417.7741772694862),
    Q11(3427.9726795281199),
    Q11(3438.1787727870123),
    Q11(3448.3924457709873),
    Q11(3458.6136872466445),
    Q11(3468.8424860221107),
    Q11(3479.0788309467976),
    Q11(3489.3227109111554),
    Q11(3499.5741148464344),
    Q11(3509.8330317244445),
    Q11(3520.0994505573185),
    Q11(3530.3733603972751),
    Q11(3540.6547503363886),
    Q11(3550.9436095063534),
    Q11(3561.239927078258),
    Q11(3571.5436922623535),
    Q11(3581.8548943078308),
    Q11(3592.1735225025936),
    Q11(3602.4995661730372),
    Q11(3612.8330146838275),
    Q11(3623.1738574376814),
    Q11(3633.5220838751502),
    Q11(3643.8776834744031),
    Q11(3654.2406457510142),
    Q11(3664.6109602577494),
    Q11(3674.9886165843564),
    Q11(3685.3736043573545),
    Q11(3695.7659132398294),
    Q11(3706.1655329312248),
    Q11(3716.5724531671399),
    Q11(3726.9866637191262),
    Q11(3737.4081543944876),
    Q11(3747.8369150360782),
    Q11(3758.2729355221072),
    Q11(3768.7162057659411),
    Q11(3779.1667157159077),
    Q11(3789.6244553551055),
    Q11(3800.0894147012082),
    Q11(3810.5615838062768),
    Q11(3821.0409527565694),
    Q11(3831.5275116723533),
    Q11(3842.0212507077194),
    Q11(3852.522160050396),
    Q11(3863.0302299215673),
    Q11(3873.5454505756893),
    Q11(3884.0678123003108),
    Q11(3894.5973054158922),
    Q11(3905.1339202756285),
    Q11(3915.6776472652732),
    Q11(3926.2284768029604),
    Q11(3936.7863993390338),
    Q11(3947.3514053558706),
    Q11(3957.9234853677135),
    Q11(3968.5026299204969),
    Q11(3979.0888295916798),
    Q11(3989.6820749900776),
    Q11(4000.2823567556948),
    Q11(4010.8896655595613),
    Q11(4021.5039921035655),
    Q11(4032.1253271202945),
    Q11(4042.7536613728694),
    Q11(4053.3889856547858),
    Q11(4064.0312907897551),
    Q11(4074.6805676315448),
    Q11(4085.3368070638221),
    Q11(4095.9999999999982),
    Q11(4106.6701373830711),
    Q11(4117.347210185475),
    Q11(4128.0312094089259),
    Q11(4138.722126084268),
    Q11(4149.4199512713267),
    Q11(4160.1246760587583),
    Q11(4170.8362915638982),
    Q11(4181.5547889326181),
    Q11(4192.2801593391769),
    Q11(4203.0123939860741),
    Q11(4213.7514841039101),
    Q11(4224.4974209512384),
    Q11(4235.2501958144258),
    Q11(4246.0098000075095),
    Q11(4256.7762248720574),
    Q11(4267.549461777031),
    Q11(4278.3295021186423),
    Q11(4289.1163373202198),
    Q11(4299.9099588320714),
    Q11(4310.7103581313495),
    Q11(4321.5175267219138),
    Q11(4332.3314561342004),
    Q11(4343.152137925088),
    Q11(4353.9795636777671),
    Q11(4364.8137250016052),
    Q11(4375.6546135320223),
    Q11(4386.5022209303588),
    Q11(4397.3565388837469),
    Q11(4408.2175591049827),
    Q11(4419.0852733324018),
    Q11(4429.9596733297531),
    Q11(4440.8407508860728),
    Q11(4451.7284978155603),
    Q11(4462.6229059574571),
    Q11(4473.5239671759227),
    Q11(4484.4316733599126),
    Q11(4495.3460164230582),
    Q11(4506.2669883035496),
    Q11(4517.1945809640119),
    Q11(4528.1287863913894),
    Q11(4539.069596596828),
    Q11(4550.0170036155587),
    Q11(4560.9709995067806),
    Q11(4571.931576353546),
    Q11(4582.898726262647),
    Q11(4593.8724413645004),
    Q11(4604.8527138130348),
    Q11(4615.8395357855816),
    Q11(4626.8328994827571),
    Q11(4637.8327971283588),
    Q11(4648.8392209692511),
    Q11(4659.8521632752563),
    Q11(4670.8716163390473),
    Q11(4681.8975724760394),
    Q11(4692.9300240242837),
    Q11(4703.9689633443595),
    Q11(4715.0143828192668),
    Q11(4726.0662748543255),
    Q11(4737.1246318770682),
    Q11(4748.1894463371373),
    Q11(4759.2607107061804),
    Q11(4770.3384174777493),
    Q11(4781.4225591671993),
    Q11(4792.5131283115852),
    Q11(4803.6101174695614),
    Q11(4814.7135192212854),
    Q11(4825.8233261683154),
    Q11(4836.9395309335096),
    Q11(4848.0621261609349),
    Q11(4859.1911045157631),
    Q11(4870.3264586841779),
    Q11(4881.4681813732768),
    Q11(4892.6162653109768),
    Q11(4903.7707032459193),
    Q11(4914.931487947375),
    Q11(4926.0986122051509),
    Q11(4937.2720688294967),
    Q11(4948.4518506510112),
    Q11(4959.637950520555),
    Q11(4970.8303613091521),
    Q11(4982.0290759079044),
    Q11(4993.2340872278974),
    Q11(5004.4453882001153),
    Q11(5015.6629717753467),
    Q11(5026.8868309241007),
    Q11(5038.1169586365131),
    Q11(5049.353347922266),
    Q11(5060.5959918104927),
    Q11(5071.8448833496996),
    Q11(5083.1000156076734),
    Q11(5094.3613816713996),
    Q11(5105.6289746469747),
    Q11(5116.9027876595246),
    Q11(5128.18281385312),
    Q11(5139.4690463906918),
    Q11(5150.7614784539473),
    Q11(5162.0601032432933),
    Q11(5173.3649139777472),
    Q11(5184.6759038948594),
    Q11(5195.9930662506322),
    Q11(5207.3163943194386),
    Q11(5218.6458813939435),
    Q11(5229.9815207850224),
    Q11(5241.3233058216847),
    Q11(5252.6712298509919),
    Q11(5264.025286237983),
    Q11(5275.3854683655954),
    Q11(5286.7517696345885),
    Q11(5298.1241834634639),
    Q11(5309.5027032883945),
    Q11(5320.887322563146),
    Q11(5332.2780347589978),
    Q11(5343.6748333646756),
    Q11(5355.0777118862716),
    Q11(5366.4866638471722),
    Q11(5377.901682787985),
    Q11(5389.3227622664635),
    Q11(5400.749895857437),
    Q11(5412.1830771527357),
    Q11(5423.622299761123),
    Q11(5435.067557308219),
    Q11(5446.5188434364318),
    Q11(5457.9761518048872),
    Q11(5469.4394760893592),
    Q11(5480.9088099821975),
    Q11(5492.3841471922606),
    Q11(5503.8654814448455),
    Q11(5515.3528064816201),
    Q11(5526.846116060552),
    Q11(5538.3454039558474),
    Q11(5549.8506639578736),
    Q11(5561.3618898731029),
    Q11(5572.8790755240361),
    Q11(5584.4022147491451),
    Q11(5595.9313014027975),
    Q11(5607.4663293552012),
    Q11(5619.0072924923297),
    Q11(5630.5541847158656),
    Q11(5642.1069999431284),
    Q11(5653.665732107017),
    Q11(5665.230375155943),
    Q11(5676.8009230537655),
    Q11(5688.3773697797333),
    Q11(5699.9597093284156),
    Q11(5711.5479357096474),
    Q11(5723.1420429484588),
    Q11(5734.7420250850209),
    Q11(5746.347876174581),
    Q11(5757.9595902874016),
    Q11(5769.5771615087006),
    Q11(5781.2005839385911),
    Q11(5792.8298516920213),
    Q11(5804.4649588987149),
    Q11(5816.1058997031105),
    Q11(5827.7526682643065),
    Q11(5839.4052587559972),
    Q11(5851.0636653664196),
    Q11(5862.7278822982908),
    Q11(5874.3979037687541),
    Q11(5886.0737240093204),
    Q11(5897.7553372658094),
    Q11(5909.4427377982956),
    Q11(5921.1359198810505),
    Q11(5932.8348778024874),
    Q11(5944.5396058651031),
    Q11(5956.2500983854261),
    Q11(5967.9663496939575),
    Q11(5979.6883541351208),
    Q11(5991.4161060672022),
    Q11(6003.1495998623004),
    Q11(6014.8888299062692),
    Q11(6026.6337905986684),
    Q11(6038.3844763527022),
    Q11(6050.1408815951781),
    Q11(6061.9030007664414),
    Q11(6073.6708283203316),
    Q11(6085.4443587241267),
    Q11(6097.2235864584891),
    Q11(6109.0085060174197),
    Q11(6120.7991119081998),
    Q11(6132.595398651345),
    Q11(6144.3973607805519),
    Q11(6156.2049928426459),
    Q11(6168.0182893975361),
    Q11(6179.8372450181578),
    Q11(6191.6618542904307),
    Q11(6203.4921118132024),
    Q11(6215.3280121982016),
    Q11(6227.1695500699925),
    Q11(6239.0167200659189),
    Q11(6250.8695168360628),
    Q11(6262.7279350431891),
    Q11(6274.5919693627056),
    Q11(6286.4616144826068),
    Q11(6298.3368651034316),
    Q11(6310.2177159382172),
    Q11(6322.1041617124456),
    Q11(6333.9961971640032),
    Q11(6345.8938170431311),
    Q11(6357.7970161123785),
    Q11(6369.7057891465583),
    Q11(6381.6201309327007),
    Q11(6393.5400362700075),
    Q11(6405.4654999698032),
    Q11(6417.3965168554978),
    Q11(6429.3330817625329),
    Q11(6441.2751895383453),
    Q11(6453.2228350423138),
    Q11(6465.176013145724),
    Q11(6477.134718731716),
    Q11(6489.0989466952469),
    Q11(6501.0686919430445),
    Q11(6513.0439493935628),
    Q11(6525.0247139769417),
    Q11(6537.010980634961),
    Q11(6549.002744321001),
    Q11(6560.9999999999973),
    Q11(6573.0027426483985),
    Q11(6585.0109672541284),
    Q11(6597.0246688165371),
    Q11(6609.0438423463656),
    Q11(6621.0684828657004),
    Q11(6633.0985854079354),
    Q11(6645.134145017727),
    Q11(6657.1751567509573),
    Q11(6669.2216156746908),
    Q11(6681.2735168671343),
    Q11(6693.3308554176001),
    Q11(6705.3936264264594),
    Q11(6717.461825005108),
    Q11(6729.535446275926),
    Q11(6741.6144853722335),
    Q11(6753.6989374382601),
    Q11(6765.7887976290967),
    Q11(6777.8840611106634),
    Q11(6789.9847230596661),
    Q11(6802.0907786635626),
    Q11(6814.2022231205201),
    Q11(6826.3190516393797),
    Q11(6838.4412594396181),
    Q11(6850.5688417513074),
    Q11(6862.701793815083),
    Q11(6874.840110882099),
    Q11(6886.9837882139991),
    Q11(6899.1328210828724),
    Q11(6911.2872047712199),
    Q11(6923.4469345719199),
    Q11(6935.6120057881863),
    Q11(6947.7824137335365),
    Q11(6959.9581537317536),
    Q11(6972.1392211168532),
    Q11(6984.3256112330409),
    Q11(6996.5173194346862),
    Q11(7008.7143410862773),
    Q11(7020.9166715623942),
    Q11(7033.1243062476678),
    Q11(7045.3372405367481),
    Q11(7057.5554698342685),
    Q11(7069.7789895548103),
    Q11(7082.0077951228714),
    Q11(7094.2418819728273),
    Q11(7106.4812455489018),
    Q11(7118.7258813051285),
    Q11(7130.9757847053224),
    Q11(7143.2309512230404),
    Q11(7155.4913763415516),
    Q11(7167.7570555538041),
    Q11(7180.0279843623894),
    Q11(7192.3041582795131),
    Q11(7204.5855728269571),
    Q11(7216.8722235360519),
    Q11(7229.1641059476406),
    Q11(7241.4612156120484),
    Q11(7253.7635480890503),
    Q11(7266.0710989478375),
    Q11(7278.3838637669869),
    Q11(7290.7018381344296),
    Q11(7303.0250176474174),
    Q11(7315.3533979124932),
    Q11(7327.6869745454596),
    Q11(7340.0257431713462),
    Q11(7352.3696994243801),
    Q11(7364.7188389479543),
    Q11(7377.0731573945968),
    Q11(7389.4326504259407),
    Q11(7401.7973137126937),
    Q11(7414.1671429346061),
    Q11(7426.5421337804428),
    Q11(7438.922281947951),
    Q11(7451.3075831438346),
    Q11(7463.6980330837177),
    Q11(7476.0936274921214),
    Q11(7488.4943621024304),
    Q11(7500.9002326568652),
    Q11(7513.3112349064522),
    Q11(7525.7273646109943),
    Q11(7538.1486175390446),
    Q11(7550.5749894678729),
    Q11(7563.0064761834419),
    Q11(7575.4430734803736),
    Q11(7587.8847771619248),
    Q11(7600.3315830399597),
    Q11(7612.7834869349153),
    Q11(7625.24048467578),
    Q11(7637.7025721000637),
    Q11(7650.1697450537677),
    Q11(7662.6419993913596),
    Q11(7675.1193309757446),
    Q11(7687.6017356782404),
    Q11(7700.0892093785433),
    Q11(7712.5817479647112),
    Q11(7725.079347333125),
    Q11(7737.5820033884729),
    Q11(7750.0897120437139),
    Q11(7762.6024692200581),
    Q11(7775.1202708469355),
    Q11(7787.6431128619733),
    Q11(7800.1709912109645),
    Q11(7812.7039018478481),
    Q11(7825.2418407346768),
    Q11(7837.7848038415968),
    Q11(7850.3327871468155),
    Q11(7862.8857866365806),
    Q11(7875.4437983051539),
    Q11(7888.006818154784),
    Q11(7900.5748421956796),
    Q11(7913.1478664459901),
    Q11(7925.725886931772),
    Q11(7938.3088996869719),
    Q11(7950.8969007533951),
    Q11(7963.4898861806851),
    Q11(7976.0878520262959),
    Q11(7988.6907943554688),
    Q11(8001.2987092412086),
    Q11(8013.911592764257),
    Q11(8026.5294410130691),
    Q11(8039.1522500837891),
    Q11(8051.7800160802271),
    Q11(8064.412735113835),
    Q11(8077.0504033036796),
    Q11(8089.6930167764222),
    Q11(8102.3405716662946),
    Q11(8114.9930641150731),
    Q11(8127.6504902720571),
    Q11(8140.3128462940449),
    Q11(8152.9801283453098),
    Q11(8165.6523325975786),
    Q11(8178.3294552300049),
    Q11(8191.0114924291529),
    Q11(8203.6984403889655),
    Q11(8216.3902953107463),
    Q11(8229.0870534031419),
    Q11(8241.7887108821069),
    Q11(8254.4952639708936),
    Q11(8267.2067089000211),
    Q11(8279.9230419072574),
    Q11(8292.6442592375952),
    Q11(8305.3703571432306),
    Q11(8318.101331883543),
    Q11(8330.8371797250657),
    Q11(8343.577896941475),
    Q11(8356.3234798135582),
    Q11(8369.0739246291978),
    Q11(8381.8292276833508),
    Q11(8394.5893852780209),
    Q11(8407.3543937222421),
    Q11(8420.1242493320569),
    Q11(8432.8989484304948),
    Q11(8445.6784873475499),
    Q11(8458.4628624201578),
    Q11(8471.2520699921806),
    Q11(8484.0461064143838),
    Q11(8496.8449680444082),
    Q11(8509.6486512467636),
    Q11(8522.4571523927953),
    Q11(8535.270467860666),
    Q11(8548.0885940353437),
    Q11(8560.9115273085663),
    Q11(8573.7392640788403),
    Q11(8586.5718007514006),
    Q11(8599.4091337382069),
    Q11(8612.2512594579148),
    Q11(8625.0981743358552),
    Q11(8637.9498748040205),
    Q11(8650.8063573010386),
    Q11(8663.6676182721567),
    Q11(8676.533654169225),
    Q11(8689.4044614506638),
    Q11(8702.2800365814601),
    Q11(8715.1603760331418),
    Q11(8728.0454762837508),
    Q11(8740.9353338178389),
    Q11(8753.8299451264356),
    Q11(8766.7293067070332),
    Q11(8779.6334150635721),
    Q11(8792.5422667064158),
    Q11(8805.4558581523324),
    Q11(8818.3741859244819),
    Q11(8831.2972465523908),
    Q11(8844.2250365719356),
    Q11(8857.1575525253265),
    Q11(8870.0947909610859),
    Q11(8883.0367484340295),
    Q11(8895.9834215052524),
    Q11(8908.934806742107),
    Q11(8921.8909007181846),
    Q11(8934.8517000132997),
    Q11(8947.817201213471),
    Q11(8960.7874009109),
    Q11(8973.7622957039603),
    Q11(8986.7418821971733),
    Q11(8999.7261570011924),
    Q11(9012.7151167327884),
    Q11(9025.7087580148236),
    Q11(9038.7070774762469),
    Q11(9051.7100717520643),
    Q11(9064.7177374833282),
    Q11(9077.7300713171153),
    Q11(9090.7470699065179),
    Q11(9103.7687299106146),
    Q11(9116.7950479944648),
    Q11(9129.8260208290812),
    Q11(9142.8616450914233),
    Q11(9155.9019174643727),
    Q11(9168.9468346367157),
    Q11(9181.9963933031358),
    Q11(9195.0505901641845),
    Q11(9208.1094219262741),
    Q11(9221.1728853016557),
    Q11(9234.240977008405),
    Q11(9247.3136937704076),
    Q11(9260.3910323173386),
    Q11(9273.472989384647),
    Q11(9286.5595617135423),
    Q11(9299.6507460509747),
    Q11(9312.7465391496207),
    Q11(9325.8469377678684),
    Q11(9338.9519386698012),
    Q11(9352.0615386251757),
    Q11(9365.1757344094131),
    Q11(9378.2945228035842),
    Q11(9391.4179005943843),
    Q11(9404.5458645741273),
    Q11(9417.6784115407263),
    Q11(9430.8155382976747),
    Q11(9443.9572416540359),
    Q11(9457.1035184244265),
    Q11(9470.2543654290002),
    Q11(9483.4097794934296),
    Q11(9496.5697574488931),
    Q11(9509.7342961320664),
    Q11(9522.9033923850911),
    Q11(9536.0770430555804),
    Q11(9549.2552449965824),
    Q11(9562.4379950665825),
    Q11(9575.6252901294793),
    Q11(9588.8171270545736),
    Q11(9602.0135027165488),
    Q11(9615.2144139954635),
    Q11(9628.4198577767274),
    Q11(9641.629830951093),
    Q11(9654.844330414644),
    Q11(9668.0633530687719),
    Q11(9681.286895820167),
    Q11(9694.5149555808002),
    Q11(9707.7475292679192),
    Q11(9720.9846138040157),
    Q11(9734.2262061168276),
    Q11(9747.4723031393187),
    Q11(9760.7229018096641),
    Q11(9773.9779990712323),
    Q11(9787.2375918725811),
    Q11(9800.5016771674327),
    Q11(9813.7702519146696),
    Q11(9827.0433130783094),
    Q11(9840.3208576275028),
    Q11(9853.602882536512),
    Q11(9866.8893847846994),
    Q11(9880.1803613565116),
    Q11(9893.4758092414686),
    Q11(9906.7757254341523),
    Q11(9920.0801069341851),
    Q11(9933.3889507462245),
    Q11(9946.7022538799429),
    Q11(9960.0200133500221),
    Q11(9973.3422261761298),
    Q11(9986.6688893829159),
    Q11(9999.9999999999945),
    Q11(10013.335555061929),
    Q11(10026.675551608221),
    Q11(10040.019986683301),
    Q11(10053.368857336509),
    Q11(10066.722160622081),
    Q11(10080.079893599144),
    Q11(10093.442053331697),
    Q11(10106.808636888598),
    Q11(10120.179641343551),
    Q11(10133.555063775095),
    Q11(10146.934901266595),
    Q11(10160.31915090622),
    Q11(10173.707809786936),
    Q11(10187.100875006496),
    Q11(10200.498343667417),
    Q11(10213.900212876984),
    Q11(10227.306479747222),
    Q11(10240.717141394889),
    Q11(10254.132194941467),
    Q11(10267.551637513146),
    Q11(10280.975466240814),
    Q11(10294.40367826004),
    Q11(10307.836270711066),
	Q11(10321.249393561528)
};

const int pow2_4_Q30[] =
{
	Q30(1.0),
	Q30(1.189207115002721), /* 2^0.25 */
	Q30(1.414213562373095), /* 2^0.5 */
	Q30(1.681792830507429)  /* 2^0.75 */
};

int dequant_rescale(AACDecoder* decoder,int channels)
{
	int g, b,sfb,num_window_groups,max_sfb,mask_present,window_group_length,ch;
	ICS_Data *ics;
	int *spec;
	int expAdjust;
	unsigned char *sfb_cb;
	short *sfb_offset,*scaleFactor;
	mask_present = decoder->ms_mask_present;
	decoder->intensity_used = 0;
	ics = &decoder->ICS_Data[0];

	for(ch=0;ch<channels;ch++)
	{
		int overFlow_Check = 0;

		decoder->pns_data_present[ch] = 0;
		if(!decoder->common_window)
			ics = &decoder->ICS_Data[ch];		
		
		if (ics->window_sequence == EIGHT_SHORT_SEQUENCE) {
			sfb_offset = (short*)(sfBandTabShort + sfBandTabShortOffset[decoder->sampRateIdx]);
			expAdjust = 6;
		} 
		else 
		{
			sfb_offset = (short*)(sfBandTabLong + sfBandTabLongOffset[decoder->sampRateIdx]);
			expAdjust = 6;
		}
		num_window_groups = ics->num_window_groups;
		max_sfb			  = ics->max_sfb;
		sfb_cb			  = decoder->sfb_cb[ch];
		scaleFactor		  = decoder->scaleFactors[ch];
		spec = decoder->coef[ch];
		for (g = 0; g < num_window_groups; g++) 
		{
			int  maxScale;
			window_group_length = ics->window_group_length[g];
			for (b = 0; b < window_group_length; b++)
			{
				int* currSpec;
				maxScale=0;
				for (sfb = 0; sfb <max_sfb; sfb++)
				{
					int size   = sfb_offset[sfb+1] - sfb_offset[sfb];
					int offset = sfb_offset[sfb];
					int cb =  sfb_cb[sfb];
					currSpec = spec+offset;
					
				    if(cb>=ZERO_HCB&&cb<=ESC_HCB)
					{
						int sf   = scaleFactor[sfb];
						int exp  = (sf>>2)-25-expAdjust;
						int frac  = (sf&3);
						int pow_frac = pow2_4_Q30[frac];
						
						for( ;size>0;size--,currSpec++)
						{
							int q;							
							q = *currSpec;
							if(q==0)
								continue;
							if(q<0)
							{
								q = -q;
							}

							if (q < TAB_SIZE)
								q = IQ_Table[q];
							else
							{
								if(q>8191)
									q=8191;
								{
									int x1 = IQ_Table[q>>3];
									int x2 = IQ_Table[(q>>3) + 1];
									q = ((q&7)*(x2-x1) << 1) + (x1 << 4);
								}
							}
				
							if (exp < 0)
							{
								q>>=-exp;
								if(frac!=0)
									q = MUL_30(q, pow_frac);
							}
							else
							{
								if(q < (MAX_INT >> exp))
								{
									q<<=exp;
									if(frac!=0)
										q = MUL_30(q, pow_frac);
								}
								else
								{
									//q = MAX_INT;
									return -1;		//overflow, it is not possible, it cause noise.
								}
							}
							
							overFlow_Check |= q;
							if(*currSpec<0)
							{
								*currSpec = -q;
							}
							else
							{
								*currSpec = q;
							}
						}						
					}
					else if(cb==NOISE_HCB)
					{						
						decoder->pns_data_present[ch] = 1;						
					}
					else if (cb == INTENSITY_HCB || cb == INTENSITY_HCB2) 
					{
						decoder->intensity_used = (ch==1);
					}				
				}
				spec += SIZE_SHORT_WIN;
			}

			sfb_cb	    += max_sfb;	
			scaleFactor += max_sfb;
		}
		decoder->gbCurrent[ch] = CLZ(overFlow_Check) - 1;
	}

	return 0;
}